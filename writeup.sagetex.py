## -*- encoding: utf-8 -*-
# This file was *autogenerated* from the file writeup.sagetex.sage.
from sage.all_cmdline import *   # import sage library
_sage_const_3 = Integer(3); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_184 = Integer(184); _sage_const_6 = Integer(6); _sage_const_5 = Integer(5); _sage_const_4 = Integer(4); _sage_const_492 = Integer(492); _sage_const_189 = Integer(189); _sage_const_263 = Integer(263); _sage_const_8 = Integer(8); _sage_const_362 = Integer(362); _sage_const_495 = Integer(495); _sage_const_477 = Integer(477); _sage_const_7 = Integer(7); _sage_const_0p01 = RealNumber('0.01'); _sage_const_p097993 = RealNumber('.097993'); _sage_const_0p6179 = RealNumber('0.6179'); _sage_const_64 = Integer(64); _sage_const_480 = Integer(480); _sage_const_0p0001 = RealNumber('0.0001'); _sage_const_1p5 = RealNumber('1.5'); _sage_const_68 = Integer(68); _sage_const_p01 = RealNumber('.01'); _sage_const_3p8 = RealNumber('3.8'); _sage_const_3p9 = RealNumber('3.9'); _sage_const_0p5 = RealNumber('0.5'); _sage_const_174 = Integer(174); _sage_const_365 = Integer(365); _sage_const_179 = Integer(179); _sage_const_9 = Integer(9); _sage_const_p095 = RealNumber('.095'); _sage_const_1p00005 = RealNumber('1.00005'); _sage_const_462 = Integer(462); _sage_const_194 = Integer(194); _sage_const_377 = Integer(377); _sage_const_199 = Integer(199); _sage_const_373 = Integer(373); _sage_const_p098 = RealNumber('.098'); _sage_const_354 = Integer(354); _sage_const_13 = Integer(13); _sage_const_p09 = RealNumber('.09'); _sage_const_p0975 = RealNumber('.0975'); _sage_const_10 = Integer(10); _sage_const_16 = Integer(16); _sage_const_p382605 = RealNumber('.382605'); _sage_const_232 = Integer(232); _sage_const_6p58211928 = RealNumber('6.58211928'); _sage_const_12 = Integer(12); _sage_const_100 = Integer(100); _sage_const_101 = Integer(101); _sage_const_p1542 = RealNumber('.1542'); _sage_const_287 = Integer(287); _sage_const_11 = Integer(11); _sage_const_p80767 = RealNumber('.80767'); _sage_const_999 = Integer(999); _sage_const_147 = Integer(147); _sage_const_225 = Integer(225); _sage_const_304 = Integer(304)## This file (writeup.sagetex.sage) was *autogenerated* from writeup.tex with sagetex.sty version 2012/01/16 v2.3.3-69dcb0eb93de.
import sagetex
_st_ = sagetex.SageTeXProcessor('writeup', version='2012/01/16 v2.3.3-69dcb0eb93de', version_check=True)
_st_.blockbegin()
try:
     beta = _sage_const_64 
     V_potential = lambda u: _sage_const_1  if (abs(u) > _sage_const_1 /_sage_const_2 ) else _sage_const_0 
except:
 _st_.goboom(_sage_const_68 )
_st_.blockend()
_st_.blockbegin()
try:
 def shooting_solver_1d_finite(psi0, dpsi0, uf, epsilon, delta_u):
     num_steps = (uf - _sage_const_0 ) / delta_u
     data = [(_sage_const_0 , psi0, dpsi0)] # initialize data array
     for i in range(num_steps): # perform forward euler
         u_old = data[i][_sage_const_0 ]
         psi_old = data[i][_sage_const_1 ]
         dpsi_old = data[i][_sage_const_2 ]
         u = u_old + delta_u
         # Taylor approximations given by (3) and (4)
         dpsi = dpsi_old - delta_u * beta \
                * (epsilon - V_potential(u_old)) * psi_old
         psi = psi_old + delta_u * dpsi_old
         data.append((u, psi, dpsi))
     return map(lambda x: (x[_sage_const_0 ], x[_sage_const_1 ]), data) # return list of (u, psi) tuples
except:
 _st_.goboom(_sage_const_101 )
_st_.blockend()
_st_.blockbegin()
try:
 import matplotlib.pyplot as plt
 def plot_finite_well(data, n, title, chained=False):
     if not chained: plt.clf() # only clear if not part of chained call
     # mirror data across origin, assumes data has a definite parity
     (u, psi0) = data[_sage_const_0 ]
     if psi0 == _sage_const_0 : # node at 0, odd
         data = map(lambda x: (-x[_sage_const_0 ], -x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
     else: # definite parity => anti-node at 0, even
         data = map(lambda x: (-x[_sage_const_0 ], x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
 
     u, psi = [[x[i] for x in data] for i in (_sage_const_0 ,_sage_const_1 )]
     plt.plot(u, psi, label="Euler Approximation")
     plt.title(title)
     plt.xlabel('$u$')
     plt.ylabel("$\\psi_{%s}(u)$" % n)
     plt.axvline(x=_sage_const_0 , color='black')
     plt.axvline(x=_sage_const_0p5 , linestyle='dashed', color='black')
     plt.axvline(x=-_sage_const_0p5 , linestyle='dashed', color='black')
     plt.grid(True)
     plt.legend()
     plt.save = plt.savefig # hack for proper SageTeX behavior
     return plt
except:
 _st_.goboom(_sage_const_147 )
_st_.blockend()
try:
 _st_.plot(_sage_const_0 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p01 , _sage_const_0p0001 ), n=_sage_const_1 , title="Guess $\epsilon =0.01$"))
except:
 _st_.goboom(_sage_const_174 )
try:
 _st_.plot(_sage_const_1 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p09 , _sage_const_0p0001 ), n=_sage_const_1 , title="Guess $\epsilon =0.09$"))
except:
 _st_.goboom(_sage_const_179 )
try:
 _st_.plot(_sage_const_2 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p095 , _sage_const_0p0001 ), n=_sage_const_1 , title="Guess $\epsilon =0.095$"))
except:
 _st_.goboom(_sage_const_184 )
try:
 _st_.plot(_sage_const_3 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p0975 , _sage_const_0p0001 ), n=_sage_const_1 , title="Guess $\epsilon =0.0975$"))
except:
 _st_.goboom(_sage_const_189 )
try:
 _st_.plot(_sage_const_4 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p098 , _sage_const_0p0001 ), n=_sage_const_1 , title="Guess $\epsilon =0.098$"))
except:
 _st_.goboom(_sage_const_194 )
try:
 _st_.plot(_sage_const_5 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p097993 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction, $\epsilon =0.097993$"))
except:
 _st_.goboom(_sage_const_199 )
try:
 _st_.plot(_sage_const_6 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_0 , _sage_const_1 , _sage_const_2 , _sage_const_p382605 , _sage_const_0p0001 ), n=_sage_const_2 , title="1st Excited Energy Eigenfunction, $\epsilon =0.382605$"))
except:
 _st_.goboom(_sage_const_225 )
try:
 _st_.plot(_sage_const_7 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_2 , _sage_const_p80767 , _sage_const_0p0001 ), n=_sage_const_3 , title="2nd Excited Energy Eigenfunction, $\epsilon =0.80767$"))
except:
 _st_.goboom(_sage_const_232 )
try:
 _st_.plot(_sage_const_8 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p0001 ), n="unbound", title="Unbound Energy State, $\epsilon =3$"))
except:
 _st_.goboom(_sage_const_263 )
try:
 _st_.plot(_sage_const_9 , format='notprovided', _p_=plot_finite_well(shooting_solver_1d_finite(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p01 ), n="unbound", title="Energy gain due to step size=0.01, $\epsilon =3$"))
except:
 _st_.goboom(_sage_const_287 )
_st_.blockbegin()
try:
 # 999 to approximate infinite potential
 V_potential = lambda u: _sage_const_999  if (abs(u) > _sage_const_1 /_sage_const_2 ) else _sage_const_0 
except:
 _st_.goboom(_sage_const_304 )
_st_.blockend()
_st_.blockbegin()
try:
 from numpy import arange
 def plot_inf_well(n, uf, data, title):
     plt.clf() # clear plot
     u = arange(-float(uf),float(uf),_sage_const_2 *float(uf)/_sage_const_100 ) # generate timespan array
     if n % _sage_const_2  != _sage_const_0 : # eigenfunction is even
         psi = [_sage_const_1  * cos(n*i*pi) for i in u]
     else: # eigenfunction is odd
         psi = [(_sage_const_1  / (n * pi)) * sin(n*i*pi) for i in u]
     # plot analytic solution
     plt.plot(u, psi, label="Analytical Solution", marker='+', linestyle='None', color='Green')
     plt.save = plt.savefig # hack for proper SageTeX behavior
     return plot_finite_well(data, n, title, chained=True) # re-use plot_finite_well to plot simulation results
except:
 _st_.goboom(_sage_const_354 )
_st_.blockend()
_st_.blockbegin()
try:
 plot_inf_well(_sage_const_1 , _sage_const_0p5 , shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_0p5 , _sage_const_p1542 , _sage_const_0p0001 ), \
               title="Ground Energy Eigenfunction, $\infty$-quantum well, $\epsilon=0.1542$")
except:
 _st_.goboom(_sage_const_362 )
_st_.blockend()
try:
 _st_.plot(_sage_const_10 , format='notprovided', _p_=plot_inf_well(_sage_const_1 , _sage_const_0p5 , shooting_solver_1d_finite(_sage_const_1 , _sage_const_0 , _sage_const_0p5 , _sage_const_p1542 , _sage_const_0p0001 ), title="Ground Energy Eigenfunction, $\infty $-quantum well, $\epsilon =0.1542$"))
except:
 _st_.goboom(_sage_const_365 )
_st_.blockbegin()
try:
 plot_inf_well(_sage_const_2 , _sage_const_0p5 , shooting_solver_1d_finite(_sage_const_0 , _sage_const_1 , _sage_const_0p5 , _sage_const_0p6179 , _sage_const_0p0001 ), \
               title="First Exctited Energy Eigenfunction, $\infty$-quantum well, \
                      $\epsilon=0.6179$")
except:
 _st_.goboom(_sage_const_373 )
_st_.blockend()
try:
 _st_.plot(_sage_const_11 , format='notprovided', _p_=plot_inf_well(_sage_const_2 , _sage_const_0p5 , shooting_solver_1d_finite(_sage_const_0 , _sage_const_1 , _sage_const_0p5 , _sage_const_0p6179 , _sage_const_0p0001 ), title="First Exctited Energy Eigenfunction, $\infty $-quantum well, $\epsilon =0.6179$") )
except:
 _st_.goboom(_sage_const_377 )
_st_.blockbegin()
try:
 hbar = _sage_const_6p58211928 *_sage_const_10 **-_sage_const_16  # eV s
 V_potential = lambda u: C * (u * x0)**_sage_const_2  / _sage_const_2 
 C = _sage_const_1 
 m = _sage_const_1 
 omega = sqrt(C / m)
 x0 = sqrt(hbar / (m * omega))
 
 def shooting_solver_qho(psi0, dpsi0, uf, epsilon, delta_u):
     num_steps = (uf - _sage_const_0 ) / delta_u
     data = [(_sage_const_0 , psi0, dpsi0)] # initialize data array
     for i in range(num_steps): # perform forward euler
         u_old = data[i][_sage_const_0 ]
         psi_old = data[i][_sage_const_1 ]
         dpsi_old = data[i][_sage_const_2 ]
         u = u_old + delta_u
         # Taylor approximations using (10)
         dpsi = dpsi_old - delta_u * (epsilon - u**_sage_const_2 ) * psi_old
         psi = psi_old + delta_u * dpsi_old
         data.append((u, psi, dpsi))
     return map(lambda x: (x[_sage_const_0 ], x[_sage_const_1 ]), data) # return list of (u, psi) tuples
 
 def plot_qho(data, n, title, chained=False):
     if not chained: plt.clf() # only clear if not part of chained call
     # mirror data across origin, assumes data has a definite parity
     (u, psi0) = data[_sage_const_0 ]
     if psi0 == _sage_const_0 : # node at 0, odd
         data = map(lambda x: (-x[_sage_const_0 ], -x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
     else: # definite parity => anti-node at 0, even
         data = map(lambda x: (-x[_sage_const_0 ], x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
 
     u, psi = [[x[i] for x in data] for i in (_sage_const_0 ,_sage_const_1 )]
     plt.plot(u, psi, label="Euler Approximation")
     plt.title(title)
     plt.xlabel('$u$')
     plt.ylabel("$\\psi_{%s}(u)$" % n)
     plt.axvline(x=_sage_const_0 , color='black')
     plt.grid(True)
     plt.legend()
     plt.save = plt.savefig
     return plt
except:
 _st_.goboom(_sage_const_462 )
_st_.blockend()
_st_.blockbegin()
try:
 plot_qho(shooting_solver_qho(_sage_const_1 , _sage_const_0 , _sage_const_3p8 , _sage_const_1p00005 , _sage_const_0p0001 ), \
               n=_sage_const_1 , title="QHO Ground State, $\epsilon=1.00005$")
except:
 _st_.goboom(_sage_const_477 )
_st_.blockend()
try:
 _st_.plot(_sage_const_12 , format='notprovided', _p_=plot_qho(shooting_solver_qho(_sage_const_1 , _sage_const_0 , _sage_const_3p9 , _sage_const_1p00005 , _sage_const_0p0001 ), n=_sage_const_1 , title="QHO Ground State, $\epsilon =1.00005$"))
except:
 _st_.goboom(_sage_const_480 )
_st_.blockbegin()
try:
 plot_qho(shooting_solver_qho(_sage_const_0 , _sage_const_1 , _sage_const_3p9 , _sage_const_3 , _sage_const_0p0001 ), \
               n=_sage_const_2 , title="QHO First Excited State, $\epsilon=3.9$")
except:
 _st_.goboom(_sage_const_492 )
_st_.blockend()
try:
 _st_.plot(_sage_const_13 , format='notprovided', _p_=plot_qho(shooting_solver_qho(_sage_const_0 , _sage_const_1 , _sage_const_3p9 , _sage_const_3 , _sage_const_0p0001 ), n=_sage_const_2 , title="QHO First Excited, $\epsilon =3.9$"))
except:
 _st_.goboom(_sage_const_495 )
_st_.endofdoc()
