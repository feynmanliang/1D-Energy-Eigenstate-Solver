## -*- encoding: utf-8 -*-
# This file was *autogenerated* from the file writeup.sagetex.sage.
from sage.all_cmdline import *   # import sage library
_sage_const_3 = Integer(3); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_7 = Integer(7); _sage_const_6 = Integer(6); _sage_const_5 = Integer(5); _sage_const_4 = Integer(4); _sage_const_189 = Integer(189); _sage_const_9 = Integer(9); _sage_const_8 = Integer(8); _sage_const_361 = Integer(361); _sage_const_348 = Integer(348); _sage_const_p80767 = RealNumber('.80767'); _sage_const_0p01 = RealNumber('0.01'); _sage_const_p097993 = RealNumber('.097993'); _sage_const_157 = Integer(157); _sage_const_171 = Integer(171); _sage_const_64 = Integer(64); _sage_const_62 = Integer(62); _sage_const_133 = Integer(133); _sage_const_206 = Integer(206); _sage_const_0p0001 = RealNumber('0.0001'); _sage_const_187 = Integer(187); _sage_const_1p5 = RealNumber('1.5'); _sage_const_280 = Integer(280); _sage_const_p01 = RealNumber('.01'); _sage_const_155 = Integer(155); _sage_const_3p9 = RealNumber('3.9'); _sage_const_0p5 = RealNumber('0.5'); _sage_const_p09 = RealNumber('.09'); _sage_const_231 = Integer(231); _sage_const_11 = Integer(11); _sage_const_p095 = RealNumber('.095'); _sage_const_1p00005 = RealNumber('1.00005'); _sage_const_262 = Integer(262); _sage_const_214 = Integer(214); _sage_const_273 = Integer(273); _sage_const_216 = Integer(216); _sage_const_271 = Integer(271); _sage_const_350 = Integer(350); _sage_const_339 = Integer(339); _sage_const_250 = Integer(250); _sage_const_p098 = RealNumber('.098'); _sage_const_252 = Integer(252); _sage_const_13 = Integer(13); _sage_const_179 = Integer(179); _sage_const_p0975 = RealNumber('.0975'); _sage_const_10 = Integer(10); _sage_const_16 = Integer(16); _sage_const_3p8 = RealNumber('3.8'); _sage_const_p382605 = RealNumber('.382605'); _sage_const_204 = Integer(204); _sage_const_6p58211928 = RealNumber('6.58211928'); _sage_const_181 = Integer(181); _sage_const_p1542 = RealNumber('.1542'); _sage_const_12 = Integer(12); _sage_const_282 = Integer(282); _sage_const_165 = Integer(165); _sage_const_163 = Integer(163); _sage_const_95 = Integer(95); _sage_const_0p6179 = RealNumber('0.6179'); _sage_const_999 = Integer(999); _sage_const_147 = Integer(147); _sage_const_229 = Integer(229); _sage_const_359 = Integer(359); _sage_const_149 = Integer(149); _sage_const_173 = Integer(173)## This file (writeup.sagetex.sage) was *autogenerated* from writeup.tex with sagetex.sty version 2012/01/16 v2.3.3-69dcb0eb93de.
import sagetex
_st_ = sagetex.SageTeXProcessor('writeup', version='2012/01/16 v2.3.3-69dcb0eb93de', version_check=True)
_st_.blockbegin()
try:
     V_potential = lambda u: _sage_const_1  if (abs(u) > _sage_const_1 /_sage_const_2 ) else _sage_const_0 
     beta = _sage_const_64 
except:
 _st_.goboom(_sage_const_62 )
_st_.blockend()
_st_.blockbegin()
try:
 def shooting_solver_finite_well(psi0, dpsi0, uf, epsilon, delta_u):
     num_steps = (uf - _sage_const_0 ) / delta_u
     data = [(_sage_const_0 , psi0, dpsi0)] # initialize data array
     for i in range(num_steps): # perform forward euler
         u_old = data[i][_sage_const_0 ]
         psi_old = data[i][_sage_const_1 ]
         dpsi_old = data[i][_sage_const_2 ]
         u = u_old + delta_u
         # Taylor approximations given by (3) and (4)
         dpsi = dpsi_old - delta_u * beta \
                * (epsilon - V_potential(u_old)) * psi_old
         psi = psi_old + delta_u * dpsi_old
         data.append((u, psi, dpsi))
     return map(lambda x: (x[_sage_const_0 ], x[_sage_const_1 ]), data) # return list of (u, psi) tuples
except:
 _st_.goboom(_sage_const_95 )
_st_.blockend()
_st_.blockbegin()
try:
 import matplotlib.pyplot as plt # use matplotlib
 def plot_data(data, n, title):
     # mirror data based on parity, assumes eigenfunction
     # has a definite parity
     (u, psi0) = data[_sage_const_0 ]
     if psi0 == _sage_const_0 : # node at 0, odd
         data = map(lambda x: (-x[_sage_const_0 ], -x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
     else: # definite parity => anti-node at 0, even
         data = map(lambda x: (-x[_sage_const_0 ], x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
 
     u, psi = [[x[i] for x in data] for i in (_sage_const_0 ,_sage_const_1 )]
     fig = plt.figure()
     plt.plot(u, psi)
     plt.title(title)
     plt.xlabel('$u$')
     plt.ylabel("$\\psi_{%s}(u)$" % n)
     plt.axvline(x=_sage_const_0 , color='black')
     plt.axvline(x=_sage_const_0p5 , linestyle='dashed', color='black')
     plt.axvline(x=-_sage_const_0p5 , linestyle='dashed', color='black')
     plt.grid(True)
 
     # plt.savefig
     # uncomment if plotting from sagetex
     plt.save = plt.savefig
     return plt
except:
 _st_.goboom(_sage_const_133 )
_st_.blockend()
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p01 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_147 )
_st_.blockend()
try:
 _st_.plot(_sage_const_0 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p01 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_149 )
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p09 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_155 )
_st_.blockend()
try:
 _st_.plot(_sage_const_1 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p09 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_157 )
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p095 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_163 )
_st_.blockend()
try:
 _st_.plot(_sage_const_2 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p095 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_165 )
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p0975 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_171 )
_st_.blockend()
try:
 _st_.plot(_sage_const_3 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p0975 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_173 )
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p098 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_179 )
_st_.blockend()
try:
 _st_.plot(_sage_const_4 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p098 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_181 )
_st_.blockbegin()
try:
 plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p097993 , _sage_const_0p0001 ), \
           n=_sage_const_1 , title="Ground Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_187 )
_st_.blockend()
try:
 _st_.plot(_sage_const_5 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_1p5 , _sage_const_p097993 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_189 )
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(_sage_const_0 , _sage_const_1 , _sage_const_2 , _sage_const_p382605 , _sage_const_0p0001 ), \
               n=_sage_const_2 , title="1st Excited Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_204 )
_st_.blockend()
try:
 _st_.plot(_sage_const_6 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_0 , _sage_const_1 , _sage_const_2 , _sage_const_p382605 , _sage_const_0p0001 ), n=_sage_const_2 , title="1st Excited Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_206 )
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(-_sage_const_1 , _sage_const_0 , _sage_const_2 , _sage_const_p80767 , _sage_const_0p0001 ), \
               n=_sage_const_3 , title="2nd Excited Energy Eigenfunction")
except:
 _st_.goboom(_sage_const_214 )
_st_.blockend()
try:
 _st_.plot(_sage_const_7 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_2 , _sage_const_p80767 , _sage_const_0p0001 ), n=_sage_const_3 , title="2nd Excited Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_216 )
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p0001 ), \
               n=_sage_const_3 , title="Unbound Energy")
except:
 _st_.goboom(_sage_const_229 )
_st_.blockend()
try:
 _st_.plot(_sage_const_8 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p0001 ), n="unbound", title="Unbound Energy Eigenfunction"))
except:
 _st_.goboom(_sage_const_231 )
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p01 ), \
               n=_sage_const_3 , title="Unbound Energy")
except:
 _st_.goboom(_sage_const_250 )
_st_.blockend()
try:
 _st_.plot(_sage_const_9 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(-_sage_const_1 , _sage_const_0 , _sage_const_5 , _sage_const_3 , _sage_const_0p01 ), n="unbound", title="Energy gain due to low step size"))
except:
 _st_.goboom(_sage_const_252 )
_st_.blockbegin()
try:
 # 999 to approximate infinite potential
 V_potential = lambda u: _sage_const_999  * int(abs(u) > _sage_const_1 /_sage_const_2 )
except:
 _st_.goboom(_sage_const_262 )
_st_.blockend()
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_0p5 , _sage_const_p1542 , _sage_const_0p0001 ), \
               n=_sage_const_1 , title="Ground Energy Eigenfunction, \
               $\infty$-quantum well")
except:
 _st_.goboom(_sage_const_271 )
_st_.blockend()
try:
 _st_.plot(_sage_const_10 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_1 , _sage_const_0 , _sage_const_0p5 , _sage_const_p1542 , _sage_const_0p0001 ), n=_sage_const_1 , title="Ground Energy Eigenfunction, $\infty $-quantum well"))
except:
 _st_.goboom(_sage_const_273 )
_st_.blockbegin()
try:
     plot_data(shooting_solver_finite_well(_sage_const_0 , _sage_const_1 , _sage_const_0p5 , _sage_const_0p6179 , _sage_const_0p0001 ), \
               n=_sage_const_2 , title="First Exctited Energy Eigenfunction, \
               $\infty$-quantum well")
except:
 _st_.goboom(_sage_const_280 )
_st_.blockend()
try:
 _st_.plot(_sage_const_11 , format='notprovided', _p_=plot_data(shooting_solver_finite_well(_sage_const_0 , _sage_const_1 , _sage_const_0p5 , _sage_const_0p6179 , _sage_const_0p0001 ), n=_sage_const_2 , title="First Excited Energy Eigenfunction, $\infty $-quantum well"))
except:
 _st_.goboom(_sage_const_282 )
_st_.blockbegin()
try:
 hbar = _sage_const_6p58211928 *_sage_const_10 **-_sage_const_16  # eV s
 C = _sage_const_1 
 m = _sage_const_1 
 
 omega = sqrt(C / m)
 x0 = sqrt(hbar / (m * omega))
 
 V_potential = lambda u: C * (u * x0)**_sage_const_2  / _sage_const_2 
 
 
 def shooting_solver_qho(psi0, dpsi0, uf, epsilon, delta_u):
     num_steps = (uf - _sage_const_0 ) / delta_u
     data = [(_sage_const_0 , psi0, dpsi0)];
     for i in range(num_steps):
         u_old = data[i][_sage_const_0 ]
         psi_old = data[i][_sage_const_1 ]
         dpsi_old = data[i][_sage_const_2 ]
         u = u_old + delta_u
         dpsi = dpsi_old - delta_u * (epsilon - u**_sage_const_2 ) * psi_old
         psi = psi_old + delta_u * dpsi_old
         data.append((u, psi, dpsi))
     return map(lambda x: (x[_sage_const_0 ], x[_sage_const_1 ]), data)
 
 def plot_data_qho(data, n, title):
     # mirror data based on parity, assumes eigenfunction
     # has a definite parity
     (u, psi0) = data[_sage_const_0 ]
     if psi0 == _sage_const_0 : # node at 0, odd
         data = map(lambda x: (-x[_sage_const_0 ], -x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
     else: # definite parity => anti-node at 0, even
         data = map(lambda x: (-x[_sage_const_0 ], x[_sage_const_1 ]), data)[::-_sage_const_1 ] + data
 
     u, psi = [[x[i] for x in data] for i in (_sage_const_0 ,_sage_const_1 )]
     fig = plt.figure()
     plt.plot(u, psi)
     plt.title(title)
     plt.xlabel('$u$')
     plt.ylabel("$\\psi_{%s}(u)$" % n)
     plt.axvline(x=_sage_const_0 , color='black')
     plt.grid(True)
 
     # plt.savefig
     # uncomment if plotting from sagetex
     plt.save = plt.savefig
     return plt
except:
 _st_.goboom(_sage_const_339 )
_st_.blockend()
_st_.blockbegin()
try:
 plot_data_qho(shooting_solver_qho(_sage_const_1 , _sage_const_0 , _sage_const_3p8 , _sage_const_1p00005 , _sage_const_0p0001 ), \
               n=_sage_const_1 , title="QHO Ground State")
except:
 _st_.goboom(_sage_const_348 )
_st_.blockend()
try:
 _st_.plot(_sage_const_12 , format='notprovided', _p_=plot_data_qho(shooting_solver_qho(_sage_const_1 , _sage_const_0 , _sage_const_3p9 , _sage_const_1p00005 , _sage_const_0p0001 ), n=_sage_const_1 , title="QHO Ground State"))
except:
 _st_.goboom(_sage_const_350 )
_st_.blockbegin()
try:
 plot_data_qho(shooting_solver_qho(_sage_const_0 , _sage_const_1 , _sage_const_3p9 , _sage_const_3 , _sage_const_0p0001 ), \
               n=_sage_const_2 , title="QHO First Excited State")
except:
 _st_.goboom(_sage_const_359 )
_st_.blockend()
try:
 _st_.plot(_sage_const_13 , format='notprovided', _p_=plot_data_qho(shooting_solver_qho(_sage_const_0 , _sage_const_1 , _sage_const_3p9 , _sage_const_3 , _sage_const_0p0001 ), n=_sage_const_2 , title="QHO First Excited"))
except:
 _st_.goboom(_sage_const_361 )
_st_.endofdoc()
